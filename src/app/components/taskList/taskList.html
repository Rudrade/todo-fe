<div class="d-flex flex-row">
  <h1 class="p-2">{{ filterName }}</h1>
  <h1 class="p-2">{{ taskCount() }}</h1>
</div>
<div class="table-responsive">
  <table class="table">
    <tbody>
      <tr (click)="onCreateTask()">
        <td>
          <i class="bi bi-plus"></i>
        </td>
        <td>Add new task</td>
        <td></td>
      </tr>
      @if (isFetchingData()) {
      <div class="d-flex justify-content-center">
        <div class="spinner-border" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
      } @else { @for (task of tasks(); track task.id) {
      <tr (click)="onOpenTask(task)">
        <td>
          <input type="checkbox" (click)="$event.stopPropagation(); onCompleteTask(task.id)" />
        </td>
        <td>
          <div>{{ task.title }}</div>
          @if (task.listName) {
          <small class="text-muted">
            <span class="list-square" [style]="listColor(task.listName)"></span>
            {{ task.listName }}
          </small>
          }
        </td>
        <td>
          <i class="bi bi-chevron-right"></i>
        </td>
      </tr>
      } }
    </tbody>
    @if (!isFetchingData() && tasks().length === 0) {
    <caption>
      No tasks found
    </caption>
    }
  </table>
</div>

@if (currentTask()) {
<app-task [data]="currentTask()" (close)="onCloseTask()" (refreshTasks)="refreshTasks()" />
}
